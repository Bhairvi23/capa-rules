rule:
  meta:
    name: encrypt data using blowfish
    namespace: data-manipulation/encryption/blowfish
    authors:
      - '@_re_fox'
    scopes:
      static: basic block
      dynamic: thread
    att&ck:
      - Defense Evasion::Obfuscated Files or Information [T1027]
    mbc:
      - Defense Evasion::Obfuscated Files or Information::Encryption-Standard Algorithm [E1027.m05]
      - Cryptography::Encrypt Data::Blowfish [C0027.002]
    examples:
      - 0761142efbda6c4b1e801223de723578:0x653E19E5
  features:
    - or:
      - and:
        - number: 0x3a39ce37 = u32 ks3 sbox4
        - number: 0xe93d5a68 = u32 ks2 sbox3
        - number: 0x4b7a70e9 = u32 ks1 sbox2
        - number: 0xd1310ba6 = u32 ks0 sbox1
