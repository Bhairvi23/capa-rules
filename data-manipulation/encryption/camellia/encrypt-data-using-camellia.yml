rule:
  meta:
    name: encrypt data using Camellia
    namespace: data-manipulation/encryption/camellia
    authors:
      - '@_re_fox'
    scopes:
      static: basic block
      dynamic: thread
    att&ck:
      - Defense Evasion::Obfuscated Files or Information [T1027]
    mbc:
      - Defense Evasion::Obfuscated Files or Information::Encryption-Standard Algorithm [E1027.m05]
      - Cryptography::Encrypt Data::Camellia [C0027.003]
    examples:
      - 0761142efbda6c4b1e801223de723578:0x6541CD50
      - 112f9f0e8d349858a80dd8c14190e620:0x4CE3B2
  features:
    - or:
      - or:
        - and:
          - number: 0x3bcc908b = CAMELLIA_SIGMA1R
          - number: 0xa09e667f = CAMELLIA_SIGMA1L
          - number: 0x4caa73b2 = CAMELLIA_SIGMA2R
          - number: 0xb67ae858 = CAMELLIA_SIGMA2L
          - number: 0xc6ef372f = CAMELLIA_SIGMA3L
          - number: 0xe94f82be = CAMELLIA_SIGMA3R
          - number: 0x54ff53a5 = CAMELLIA_SIGMA4L
          - number: 0xf1d36f1c = CAMELLIA_SIGMA4R
          - number: 0x10e527fa = CAMELLIA_SIGMA5L
          - number: 0xde682d1d = CAMELLIA_SIGMA5R
          - number: 0xb05688c2 = CAMELLIA_SIGMA6L
          - number: 0xb3e6c1fd = CAMELLIA_SIGMA6R
        - and:
          - string: "/A09E667F3BCC908B/i"
            description: sigma1_str
          - string: "/B67AE8584CAA73B"
            description: sigma2_str
          - string: "/C6EF372FE94F82BE/i"
            description: sigma3_str
          - string: "/54FF53A5F1D36F1C/i"
            description: sigma4_str
          - string: "/10E527FADE682D1D/i"
            description: sigma5_str
          - string: "/B05688C2B3E6C1FD/i"
            description: sigma6_str
