rule:
  meta:
    name: encrypt data using RC4 KSA
    namespace: data-manipulation/encryption/rc4
    authors:
      - moritz.raabe@mandiant.com
    scopes:
      static: function
      dynamic: process
    att&ck:
      - Defense Evasion::Obfuscated Files or Information [T1027]
    mbc:
      - Cryptography::Encrypt Data::RC4 [C0027.009]
      - Cryptography::Encryption Key::RC4 KSA [C0028.002]
    examples:
      - 34404A3FB9804977C6AB86CB991FB130:0x403D40
      - 9324D1A8AE37A36AE560C37448C9705A:0x404950
      - 2B8BEC5BCB1777EAA155D832F7AFC797:0x405C42
      - 73CE04892E5F39EC82B00C02FC04C70F:0x40646E
  features:
    - or:
      - and:
        - description: write DWORDs instead of bytes
        - or:
          - number: 0x03020100
          - number: 0xFFFEFDFC
        - instruction:
          - or:
            - mnemonic: add
            - mnemonic: sub
          - number: 0x04040404
